Walmart says it will be testing its grocery delivery service with ride-hailing companies Uber and Lyft in the next two weeks in Denver and Phoenix.

That’s in addition to a quiet pilot program that started in March with Deliv for its Sam’s Club customers that involves delivery of general merchandise and grocery for business members in Miami.

The move is the latest step in the retailer’s efforts to better compete with Amazon, which is delivering groceries directly to shoppers’ homes in several markets.

Walmart’s test works this way: A customer in one of the test locations orders groceries online and then selects a delivery window. A personal shopper then selects the products and the team may request a driver from one of these services to go to the store, pick up the customer’s order and take it directly to the customer’s location.

Customers pay Walmart the regular $7 to $10 delivery charge online and make no payments to the driver.

“We’re thrilled about the possibility of delivering new convenient options to our customers, and about working with some transformative companies in this test,” Michael Bender, executive vice president and chief operating officer of Walmart Global e-commerce wrote in a blog posted Friday.

He noted that the company will “start small and let our customers guide us.”

The tests with Uber and others come as Walmart is also rapidly expanding its curbside grocery delivery to 14 new markets for a total of 54 markets and in over 200 stores. That allows customers to order groceries online and then pick them up outside their local store.

Walmart says 90 percent of its curbside customers are repeat users and more than 90 percent of its baskets include fresh grocery items like dairy and produce.

It’s also been testing grocery home delivery service in Denver and in San Jose, Calif.

Walmart’s main focus, however, has been further capitalizing on its power to combine its brick-and-mortar stores with online shopping.